Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"d8b352aa-e62a-4b10-b4a1-f0b7f529d303\" name=\"Changes\" comment=\"\">\n      <change afterPath=\"$PROJECT_DIR$/distributions.py\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"FileTemplateManagerImpl\">\n    <option name=\"RECENT_TEMPLATES\">\n      <list>\n        <option value=\"Python Script\" />\n      </list>\n    </option>\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n  </component>\n  <component name=\"MarkdownSettingsMigration\">\n    <option name=\"stateVersion\" value=\"1\" />\n  </component>\n  <component name=\"ProjectId\" id=\"286lc3q2Pdeol8JWLyDnUL8E3Jb\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"RunManager\">\n    <configuration name=\"distributions\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\n      <module name=\"Project3\" />\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\n      <option name=\"PARENT_ENVS\" value=\"true\" />\n      <envs>\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\n      </envs>\n      <option name=\"SDK_HOME\" value=\"/usr/local/bin/python3.8\" />\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\n      <option name=\"IS_MODULE_SDK\" value=\"false\" />\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/distributions.py\" />\n      <option name=\"PARAMETERS\" value=\"\" />\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\n      <option name=\"MODULE_MODE\" value=\"false\" />\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\n      <option name=\"INPUT_FILE\" value=\"\" />\n      <method v=\"2\" />\n    </configuration>\n    <recent_temporary>\n      <list>\n        <item itemvalue=\"Python.distributions\" />\n      </list>\n    </recent_temporary>\n  </component>\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"d8b352aa-e62a-4b10-b4a1-f0b7f529d303\" name=\"Changes\" comment=\"\" />\n      <created>1650544993883</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1650544993883</updated>\n    </task>\n    <servers />\n  </component>\n  <component name=\"XDebuggerManager\">\n    <breakpoint-manager>\n      <breakpoints>\n        <line-breakpoint enabled=\"true\" suspend=\"THREAD\" type=\"python-line\">\n          <url>file://$PROJECT_DIR$/distributions.py</url>\n          <line>29</line>\n          <option name=\"timeStamp\" value=\"1\" />\n        </line-breakpoint>\n      </breakpoints>\n    </breakpoint-manager>\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision afcd5f10c711cb0e3bb1ead339e7b168c2210042)
+++ b/.idea/workspace.xml	(date 1650821764495)
@@ -1,8 +1,13 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
+  <component name="AutoImportSettings">
+    <option name="autoReloadType" value="SELECTIVE" />
+  </component>
   <component name="ChangeListManager">
-    <list default="true" id="d8b352aa-e62a-4b10-b4a1-f0b7f529d303" name="Changes" comment="">
-      <change afterPath="$PROJECT_DIR$/distributions.py" afterDir="false" />
+    <list default="true" id="d8b352aa-e62a-4b10-b4a1-f0b7f529d303" name="Changes" comment="?">
+      <change afterPath="$PROJECT_DIR$/sample/data_518.csv" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/structEqModel.py" beforeDir="false" afterPath="$PROJECT_DIR$/structEqModel.py" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -23,9 +28,18 @@
     <option name="stateVersion" value="1" />
   </component>
   <component name="ProjectId" id="286lc3q2Pdeol8JWLyDnUL8E3Jb" />
+  <component name="ProjectLevelVcsManager" settingsEditedManually="true">
+    <ConfirmationsSetting value="2" id="Add" />
+  </component>
   <component name="ProjectViewState">
     <option name="hideEmptyMiddlePackages" value="true" />
     <option name="showLibraryContents" value="true" />
+  </component>
+  <component name="PropertiesComponent">
+    <property name="ASKED_ADD_EXTERNAL_FILES" value="true" />
+    <property name="RunOnceActivity.OpenProjectViewOnStart" value="true" />
+    <property name="RunOnceActivity.ShowReadmeOnStart" value="true" />
+    <property name="settings.editor.selected.configurable" value="preferences.lookFeel" />
   </component>
   <component name="RunManager">
     <configuration name="distributions" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
@@ -64,7 +78,31 @@
       <option name="presentableId" value="Default" />
       <updated>1650544993883</updated>
     </task>
+    <task id="LOCAL-00001" summary="?">
+      <created>1650546538067</created>
+      <option name="number" value="00001" />
+      <option name="presentableId" value="LOCAL-00001" />
+      <option name="project" value="LOCAL" />
+      <updated>1650546538067</updated>
+    </task>
+    <option name="localTasksCounter" value="2" />
     <servers />
+  </component>
+  <component name="Vcs.Log.Tabs.Properties">
+    <option name="TAB_STATES">
+      <map>
+        <entry key="MAIN">
+          <value>
+            <State />
+          </value>
+        </entry>
+      </map>
+    </option>
+  </component>
+  <component name="VcsManagerConfiguration">
+    <option name="ADD_EXTERNAL_FILES_SILENTLY" value="true" />
+    <MESSAGE value="?" />
+    <option name="LAST_COMMIT_MESSAGE" value="?" />
   </component>
   <component name="XDebuggerManager">
     <breakpoint-manager>
Index: sample/data_518.csv
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/sample/data_518.csv b/sample/data_518.csv
new file mode 100644
--- /dev/null	(date 1650548032538)
+++ b/sample/data_518.csv	(date 1650548032538)
@@ -0,0 +1,251 @@
+,A,B,C,D
+0,1.0,1.396837907801877,0.4632739827906658,-0.3968379078018771
+1,1.0,-0.2877139320924743,0.7330686042909823,3.2877139320924744
+2,1.0,-0.012444778197211182,1.5026154807323902,1.0124447781972112
+3,1.0,-0.303031172955077,0.16689307883543547,2.3030311729550768
+4,1.0,1.298176240369286,-0.6031108100521805,-0.298176240369286
+5,1.0,0.7873853302397555,-0.03912110654963348,0.21261466976024446
+6,1.0,0.32667594117719145,0.9614813567204954,1.6733240588228084
+7,1.0,-0.05045161889025851,0.7412775206295218,3.0504516188902584
+8,1.0,1.1628111136686643,0.24620857359611717,1.8371888863313357
+9,1.0,1.2413443944668892,-0.33858294449330195,0.7586556055331108
+10,1.0,-0.02332973589704579,-0.9372151299020073,3.023329735897046
+11,1.0,-0.015073618124987531,2.4589152043420253,2.0150736181249878
+12,1.0,-0.4477809928838206,-1.5684906132064997,1.4477809928838206
+13,1.0,-0.29982266368173405,0.7472663347850792,1.299822663681734
+14,1.0,0.5249983026738749,1.8132095823741678,1.475001697326125
+15,1.0,-0.24393261643041486,-0.141858621542755,3.2439326164304148
+16,1.0,-0.14181113213028107,1.0866923893968816,2.141811132130281
+17,1.0,1.2994194195368467,1.1279913961575647,0.7005805804631533
+18,1.0,-0.19483546305252059,-0.7676162275300913,2.1948354630525206
+19,1.0,-0.07873390291746696,0.5831141972039341,2.0787339029174667
+20,1.0,0.16842139981634852,-2.0018655987783007,2.8315786001836516
+21,1.0,0.8126822692166837,-1.16809830676586,0.18731773078331626
+22,1.0,-0.06959495480756261,-0.5452879558249969,1.0695949548075627
+23,1.0,0.7527392957441519,0.3238533852645925,0.24726070425584812
+24,1.0,0.20022763757116946,1.0716547712865092,1.7997723624288304
+25,1.0,-0.06504587190009625,0.4195692218111607,1.0650458719000961
+26,1.0,-0.22155647130981404,-0.30494190820476624,2.221556471309814
+27,1.0,-0.17395436925477725,1.939610109352022,1.1739543692547771
+28,1.0,-0.621785832933207,0.027792323531843466,2.621785832933207
+29,1.0,1.288120473513752,-1.2728772837559308,-0.2881204735137519
+30,1.0,-0.176741872882215,-2.5908799155608486,1.176741872882215
+31,1.0,-0.4870448385332161,1.8236164435289406,1.4870448385332162
+32,1.0,-0.6622686309520516,0.35683948550391903,1.6622686309520516
+33,1.0,-0.03546490715808681,1.2424831564628698,2.0354649071580866
+34,1.0,-0.6284811064913891,-0.11947111865687025,1.628481106491389
+35,1.0,1.1981840467313511,-0.25427607371981603,-0.19818404673135115
+36,1.0,0.2926715234482413,1.6522482463795694,2.7073284765517585
+37,1.0,0.8164801970101785,1.7285134075652362,0.1835198029898215
+38,1.0,-0.5243197871300678,-1.1969976141584273,2.524319787130068
+39,1.0,-0.571259260177913,-0.3402093324477162,1.571259260177913
+40,1.0,-0.2489890454458733,-0.07773421571118476,2.248989045445873
+41,1.0,0.6324178521849677,0.5276581729072634,0.3675821478150323
+42,1.0,0.18174657024040175,-3.226000852701796,1.8182534297595982
+43,1.0,-0.33228912771236185,0.20808384085895762,1.3322891277123619
+44,1.0,-0.1639946361654775,-0.38835398604651356,1.1639946361654774
+45,1.0,-0.7179800950706665,0.7431651940356018,1.7179800950706665
+46,1.0,0.6946595957700917,-0.30494164326396617,0.30534040422990827
+47,1.0,-0.21700928869363656,0.1280066130133407,1.2170092886936366
+48,1.0,-0.6493766630821092,-1.173068384270282,2.6493766630821094
+49,1.0,0.07034792780295718,-1.2923415943402192,2.929652072197043
+50,1.0,0.0004867981487285955,1.5901951252264814,1.9995132018512713
+51,1.0,-0.5918947931880683,0.5912995858606508,3.591894793188068
+52,1.0,0.9951249125586779,-1.99319356856094,1.0048750874413221
+53,1.0,0.5944445255062558,-3.0976201903774623,1.4055554744937442
+54,1.0,0.7029655024452377,-1.6299343287221324,0.2970344975547623
+55,1.0,-0.17848816333447082,2.693326866695311,1.1784881633344708
+56,1.0,-0.04047795503642648,0.45832655695356717,1.0404779550364265
+57,1.0,0.4334115614110207,1.0208199844254044,2.5665884385889792
+58,1.0,1.138449634793682,0.21895508169473127,-0.1384496347936821
+59,1.0,1.3468558931930161,0.1546410540866272,0.6531441068069839
+60,1.0,-0.17038737783779068,0.010322980299931454,1.1703873778377907
+61,1.0,-0.20546746884741934,-0.6321534262652069,3.205467468847419
+62,1.0,1.0018996518239236,1.9842699684869625,0.9981003481760764
+63,1.0,-0.1714382196193529,-0.6615222889112056,1.171438219619353
+64,1.0,1.3892932631094954,0.4708844001552517,0.6107067368905046
+65,1.0,1.291099573204522,2.499864542976537,-0.29109957320452207
+66,1.0,-0.2462402759918857,1.3300222946805886,2.2462402759918856
+67,1.0,-0.17942585593799065,0.08040714790902985,3.179425855937991
+68,1.0,1.0462624007921963,0.7260608972277686,0.9537375992078037
+69,1.0,0.016880668032488777,0.614895589591179,2.983119331967511
+70,1.0,-0.05233674458847143,0.9517480759499332,2.0523367445884713
+71,1.0,-0.04040260746402424,2.938347283808748,1.0404026074640242
+72,1.0,-0.6492760902259798,0.27940614034154504,3.64927609022598
+73,1.0,1.5151338558569054,0.9052585758265005,-0.5151338558569054
+74,1.0,0.23357677325662918,-0.9141029627659196,1.7664232267433708
+75,1.0,-0.38481389337367233,0.5582856534259821,1.3848138933736722
+76,1.0,-0.2637992919930472,-0.25701578557539884,2.263799291993047
+77,1.0,1.3312495713043004,-1.8787665055619422,1.6687504286956996
+78,1.0,-0.4087306443471255,-1.401099319958134,2.4087306443471257
+79,1.0,0.20152440035334585,-0.6416225238733786,1.7984755996466542
+80,1.0,0.2455752910849851,-2.826335941787243,0.7544247089150149
+81,1.0,1.021047841501781,-1.0701699629679233,-0.02104784150178096
+82,1.0,1.4197456347735247,-0.24368448429948147,1.5802543652264753
+83,1.0,0.30999780303835034,-0.33860552806427013,0.6900021969616497
+84,1.0,0.5037995992347117,0.33012127128956714,2.4962004007652885
+85,1.0,-0.5067105390317808,1.3393984916378021,3.506710539031781
+86,1.0,-0.3274963740128126,0.9352638950729341,1.3274963740128127
+87,1.0,-0.259566206427281,-0.36338550487859034,2.259566206427281
+88,1.0,-0.2236867531875527,0.48791291191416036,3.2236867531875526
+89,1.0,0.06800924118112445,1.314854674916239,0.9319907588188756
+90,1.0,0.2734810302199645,1.5089244644276538,0.7265189697800355
+91,1.0,1.5750750259492845,0.8786883239695544,-0.5750750259492845
+92,1.0,1.688276615590008,0.2963150427019555,0.31172338440999203
+93,1.0,-0.22303424716702602,1.6687770214359707,1.2230342471670261
+94,1.0,-0.007617889270655043,-1.2652788264060943,3.007617889270655
+95,1.0,-0.02852961862620995,-0.36641924239218077,1.02852961862621
+96,1.0,-0.3206389041883996,-1.0748886737758931,1.3206389041883995
+97,1.0,0.694158199615932,-0.19248706596886925,0.30584180038406805
+98,1.0,-0.13009398216822798,-0.03426661406544133,1.130093982168228
+99,1.0,-0.19567868834024577,-0.5919811550333091,1.1956786883402457
+100,1.0,0.42063001889826257,-0.2611801434514533,1.5793699811017374
+101,1.0,-0.17909432845849405,-1.9627079560737406,1.179094328458494
+102,1.0,1.60404391425677,-0.5753190927201387,-0.60404391425677
+103,1.0,1.717830088816676,-2.3935600215229416,0.282169911183324
+104,1.0,0.6264525929453,-1.163456134764147,1.3735474070547
+105,1.0,0.7338871585808475,0.23956772488789085,1.2661128414191525
+106,1.0,-0.478732245022264,0.2980176195667303,3.478732245022264
+107,1.0,-0.3761137621930694,-1.7080357218552613,3.3761137621930692
+108,1.0,1.4466015693317729,0.9576765838288919,-0.44660156933177286
+109,1.0,0.01812691919196041,-1.9449288680934826,0.9818730808080396
+110,1.0,1.3783018157027387,0.04458345168140567,1.6216981842972613
+111,1.0,0.5136341598244911,0.6036312769562704,0.4863658401755089
+112,1.0,0.7810700324619998,0.5444977596784748,1.218929967538
+113,1.0,-0.3450410078450956,0.02912695784150498,2.3450410078450954
+114,1.0,0.9997021633524044,-0.036981201818893736,0.00029783664759563955
+115,1.0,0.33926389995983464,0.4318528661339383,2.6607361000401655
+116,1.0,0.33074858616041114,-1.2182310592062926,2.669251413839589
+117,1.0,0.050702978151817124,-0.21281517624420426,0.9492970218481829
+118,1.0,-0.4230323568719282,-2.184953671132327,1.423032356871928
+119,1.0,0.87125847422113,-0.9671650234573687,2.12874152577887
+120,1.0,0.23331326873377956,0.8882928726522278,0.7666867312662204
+121,1.0,0.1385650940202553,2.303204090132039,1.8614349059797446
+122,1.0,0.7490649477913628,0.9534045906353161,0.2509350522086372
+123,1.0,-0.6053148816203053,0.2032974860011263,1.6053148816203053
+124,1.0,-0.2964864655526933,2.094951575334214,1.2964864655526933
+125,1.0,0.18091389410672176,-0.9232911574878703,2.819086105893278
+126,1.0,0.08063686093568634,-1.2905997804385851,0.9193631390643137
+127,1.0,-0.011448605306745463,1.3681491785114472,2.0114486053067453
+128,1.0,-0.4571704990000411,4.015255804745482,2.457170499000041
+129,1.0,-0.42418224577313357,0.600121134536464,1.4241822457731335
+130,1.0,-0.06016957126981237,1.2574481053736593,2.0601695712698125
+131,1.0,-0.4523541553027782,3.419637037649667,1.4523541553027783
+132,1.0,-0.4760259344171637,-0.5495328640341263,1.4760259344171636
+133,1.0,0.8819051374610924,1.8839738326202022,2.1180948625389076
+134,1.0,-0.1702731077021618,1.060348968875193,2.1702731077021618
+135,1.0,0.5908123405921978,-0.5675105781321595,2.4091876594078023
+136,1.0,-0.831369285726979,-1.5282950528417023,1.831369285726979
+137,1.0,0.6876194261569769,1.1938916027128064,2.312380573843023
+138,1.0,-0.383061325171534,-0.09401006419361371,1.383061325171534
+139,1.0,0.9006051036161447,0.5342315971609182,0.09939489638385535
+140,1.0,0.006003478043225652,1.8188477688558053,0.9939965219567743
+141,1.0,0.9303360304816128,0.659075753489473,0.06966396951838716
+142,1.0,-0.13611599491817272,-0.0843467746173075,2.136115994918173
+143,1.0,0.7674778815820246,-0.5033853583853902,1.2325221184179753
+144,1.0,-0.21001044520215417,0.9256244736408157,3.2100104452021543
+145,1.0,-0.2518582647762436,-0.2526641113680915,2.2518582647762435
+146,1.0,0.5794352090975315,1.4397899127607627,0.42056479090246845
+147,1.0,-0.17676123908530716,1.5433888747742344,2.176761239085307
+148,1.0,1.3499969133694678,-0.0034276452949048215,-0.3499969133694678
+149,1.0,-0.0018019031601110846,1.922526679274701,2.001801903160111
+150,1.0,-0.7925889352226962,1.0859157454852766,1.7925889352226962
+151,1.0,-0.48161358978090757,-0.5621945239909398,2.4816135897809075
+152,1.0,-0.7630600076017958,-0.5322765154171266,2.763060007601796
+153,1.0,-0.25656416532220483,0.13067777760767377,1.2565641653222048
+154,1.0,0.10788892124738148,0.8839869322864852,0.8921110787526185
+155,1.0,0.9575988563997555,1.081380847808694,1.0424011436002445
+156,1.0,-0.6277219956698581,-0.5198192208854446,1.627721995669858
+157,1.0,1.7091128853923876,-0.21099547749472713,-0.7091128853923876
+158,1.0,-0.3544556863705165,1.9637812524436744,1.3544556863705166
+159,1.0,1.3081006786007743,-1.0641861918165847,0.6918993213992257
+160,1.0,0.7446601460969746,1.7305697292499045,1.2553398539030254
+161,1.0,-0.1908187609670317,0.04329828639219157,1.1908187609670318
+162,1.0,0.10964958896818877,-0.04722527136639021,0.8903504110318112
+163,1.0,-0.5722370833974184,2.5389949352198267,1.5722370833974184
+164,1.0,0.40488470898705375,0.5378592469917967,1.5951152910129462
+165,1.0,0.21304248909882328,1.8605420068297092,1.7869575109011766
+166,1.0,1.5280481686700873,-1.1480735985672739,0.4719518313299127
+167,1.0,0.052549525560241284,0.7602374259747835,0.9474504744397587
+168,1.0,0.13374457992393596,0.2421541670635236,0.866255420076064
+169,1.0,-0.27390779664031717,0.3739432173331946,1.2739077966403172
+170,1.0,-0.1459753553938138,1.3013962723260935,3.145975355393814
+171,1.0,-0.5001650889254028,0.5526966330380055,2.500165088925403
+172,1.0,-0.6491292999164505,-1.5166218752705105,3.6491292999164506
+173,1.0,-0.1504393489953194,-0.3251354334440255,2.1504393489953193
+174,1.0,-0.186132500215896,1.115520049845642,1.186132500215896
+175,1.0,1.1692033514752718,1.0541440351934521,0.8307966485247282
+176,1.0,0.8981250395467943,-0.5447356396409951,0.10187496045320565
+177,1.0,0.3026597465697839,0.23458402076206852,0.6973402534302161
+178,1.0,-0.13528831025184646,-1.027301776945223,2.1352883102518465
+179,1.0,1.5550476001311133,-0.3209779800114999,-0.5550476001311133
+180,1.0,-0.4144909856877965,0.7813126447079302,3.4144909856877965
+181,1.0,-0.06873354879444982,0.6234629179830544,2.06873354879445
+182,1.0,-0.4582496390788777,-1.3931768572866228,2.4582496390788777
+183,1.0,-0.35285897647001974,-0.22934315603637997,3.35285897647002
+184,1.0,0.8236065545682238,0.40386793723823,0.17639344543177615
+185,1.0,0.4180331129046199,-1.089390935681096,1.58196688709538
+186,1.0,-0.4190263013930826,0.12055490632268186,1.4190263013930826
+187,1.0,-0.5386763127972339,0.3143562518142599,1.538676312797234
+188,1.0,0.39036663799535937,0.763348065136635,2.6096333620046406
+189,1.0,-0.37095775683874355,-0.9776659175771223,1.3709577568387434
+190,1.0,-0.34735854711656033,0.6400359378706632,1.3473585471165603
+191,1.0,0.41131784434349417,-0.5323057847387578,2.588682155656506
+192,1.0,0.8529000563935681,0.4648929748430332,0.14709994360643186
+193,1.0,-0.24673158541640516,-0.2957445900984802,1.2467315854164052
+194,1.0,1.1769877911961364,1.325707389475156,-0.1769877911961364
+195,1.0,0.8133831358162324,-0.744697907361443,0.18661686418376755
+196,1.0,0.8871006830699761,-1.5685213097245962,1.1128993169300239
+197,1.0,0.1849638621243288,0.3020666881502873,0.8150361378756712
+198,1.0,-0.4803686620970886,0.2687891442138059,1.4803686620970886
+199,1.0,-0.08222142541573974,0.29788325653862385,1.0822214254157396
+200,1.0,-0.5527848205011846,-2.7966600729611493,1.5527848205011847
+201,1.0,0.2585554556515377,-0.29349115699307426,2.7414445443484623
+202,1.0,1.3835235219623487,0.9442476621180222,0.6164764780376513
+203,1.0,-0.2870003800818335,-0.2707086381460937,1.2870003800818335
+204,1.0,-0.3454263570972309,0.8041385106305596,1.345426357097231
+205,1.0,-0.24908895987565816,-1.3909751498000336,2.249088959875658
+206,1.0,-0.1287711620340376,0.387919862919064,2.1287711620340377
+207,1.0,-0.006867426205012128,-1.3400981451412288,2.0068674262050124
+208,1.0,-0.17702222568621473,-0.3975314760681168,1.1770222256862146
+209,1.0,1.2079279468211679,2.0682421542840426,-0.20792794682116789
+210,1.0,-0.1923165763720417,0.038469248025356034,2.1923165763720416
+211,1.0,1.6090319115011114,0.1746607717652726,1.3909680884988886
+212,1.0,-0.26787959755497254,1.0043195022775253,2.2678795975549724
+213,1.0,-0.2689117781931548,0.3879026740246923,2.268911778193155
+214,1.0,-0.26410780327301875,-0.7349611223741043,1.2641078032730189
+215,1.0,1.2437597678259817,-0.7192975211268186,-0.24375976782598174
+216,1.0,1.2079162918950792,0.25481808723845056,0.7920837081049208
+217,1.0,1.1022026360628847,1.636189962993987,0.8977973639371153
+218,1.0,-0.18197720418381613,-1.5613022164621886,1.1819772041838161
+219,1.0,0.9904141589573096,1.3768020021086849,0.009585841042690446
+220,1.0,0.11919547445592527,-0.5145823413958526,2.880804525544075
+221,1.0,1.0767411753625198,-0.8560447928120305,0.9232588246374802
+222,1.0,0.08077996042261348,1.2896641008576593,1.9192200395773864
+223,1.0,-0.3391336773880528,-1.1202312931825364,2.3391336773880527
+224,1.0,0.3131466989433933,1.2095398453821653,2.6868533010566065
+225,1.0,-0.4452036793080016,0.285231092618748,1.4452036793080016
+226,1.0,-0.14943292279518616,0.7889244920462153,3.149432922795186
+227,1.0,0.1384145424474712,-0.44935297853648826,0.8615854575525288
+228,1.0,0.23299934965265495,-0.5874358706856828,1.767000650347345
+229,1.0,-0.0739695113458877,-0.3971863553977595,1.0739695113458878
+230,1.0,-0.5594827865083548,-1.2908730252407035,1.559482786508355
+231,1.0,-0.03777245467669982,0.7792990370374211,1.0377724546766998
+232,1.0,1.5185998363570632,-0.021786179115229145,0.4814001636429368
+233,1.0,0.7638410788099611,-0.4653531690122439,1.236158921190039
+234,1.0,-0.42543962805699304,-0.33851421203285875,3.425439628056993
+235,1.0,0.12777852609233278,-0.19918879166968603,2.872221473907667
+236,1.0,0.4334353961343826,-1.0713544045480028,0.5665646038656174
+237,1.0,0.5357462693689095,-1.1890962740628304,0.46425373063109054
+238,1.0,-0.36548470428254565,-0.2019159266643775,1.3654847042825455
+239,1.0,0.937164989718835,-1.285427696607885,0.062835010281165
+240,1.0,-0.9061265942156175,0.6114149442523065,2.9061265942156176
+241,1.0,-0.260243442341209,-1.6289777935471932,1.260243442341209
+242,1.0,0.266021610850548,-0.44301117187939637,0.733978389149452
+243,1.0,1.5106381041621533,0.5025710460390213,-0.5106381041621533
+244,1.0,-0.7455613231827822,0.9879354491023948,1.7455613231827822
+245,1.0,1.1612693965426328,0.6620442577533154,-0.16126939654263284
+246,1.0,-0.20612424546818098,-1.016750240013499,1.2061242454681809
+247,1.0,-0.0745505657358927,-1.9665747481123472,3.0745505657358927
+248,1.0,-0.3543723111148417,-1.9758961813917775,1.3543723111148416
+249,1.0,-0.08530098381029505,0.8557173577895132,1.0853009838102952
Index: structEqModel.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import numpy as np\nimport matplotlib.pyplot as plt\n\nclass structEqModel():\n    def __init__(self, n, intervene = False):\n        self.a = (np.random.exponential(1/7, n))\n        self.b = (np.random.normal(1, 4, n))\n\n        if intervene:\n            self.c = 1\n        else:\n            self.c = np.where(np.random.multinomial(1, [1/6, 2/6, 3/6], n) == 1)[1]+1\n\n        self.d = self.a + self.b + 30 * np.random.binomial(n, 2/5, None)\n        self.e = self.b + 20 * self.c\n        self.f = (2/3) * self.d + self.e\n\n    def plotHist(self, dist=None, bins=20):\n        import matplotlib.pyplot as plt\n        if dist is not None:\n            dists = [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"]\n            distsModel = [self.a, self.b, self.c, self.d, self.e, self.f]\n\n            if (len(dist) > 1):\n                for i in range(len(dist)):\n                    plt.suptitle('Model distribution ' + dist[i])\n                    plt.hist(distsModel[dist.index(dist[i])], bins=bins, label=dists[dist.index(dist[i])])\n                    plt.show()\n\n            else:\n                plt.hist(distsModel[dists.index(dist)], bins=bins)\n                plt.show()\n        else:\n            print(\"Error: no distribution is given\")\n\n    def plotSamples(self, samples, node='all', pd = False):\n        if pd and node != 'all':\n            plt.hist(samples[node], bins=20)\n            plt.show()misc\n\n        else:\n            all_nodes = ['A', 'B', 'C', 'D']\n            if node !='all':\n                nodeidx = all_nodes.index(node) + 1\n                plt.hist(samples[nodeidx], bins = 5)\n                plt.show()\n\n            elif node=='all':\n                nodes = all_nodes\n\n            else:\n                print(\"Error: node not found\")\n\n    def mixedVar(self, sigmax, sigmay, a, b, sigmaz=None, c=None):\n        if sigmaz is None and c is None:\n            return a ** 2 * sigmax ** 2 + b ** 2 * sigmay ** 2 + 2 * a * b * sigmax * sigmay\n        else:\n            return a ** 2 * sigmax ** 2 + b ** 2 * sigmay ** 2 + c ** 2 * sigmaz ** 2 + 2 * a * b * sigmax * sigmay * sigmaz\n\n    def loadData(self, path, pd = False):\n        from sampleLoad import sampleLoad, sampleLoadPd\n        if pd:\n            self.data = sampleLoadPd(path)\n        else:\n            self.data = sampleLoad(path)\n        return self.data\n\nif __name__ == \"__main__\":\n    from tabulate import tabulate\n\n    # set random seed for numpy\n    np.random.seed(0)\n    model = structEqModel(n=1000)\n\n    print(\"Var[B] = \", model.mixedVar(2, (-1 / 2), 1 / 2, 1))\n    print(\"\\nVar[C] = \", model.mixedVar(2, 1, 1, 1))\n    print(\"\\nVar[D] = \", model.mixedVar(sigmax=model.mixedVar(2, (-1 / 2), 1 / 2, 1), sigmay=model.mixedVar(2, 1, 1, 1),\n                                        a=2 / 3, b=-(1 / 2), sigmaz=1, c=1))\n\n    data = [['A', round(np.mean(model.a), 3), round(np.var(model.a), 3)],\n            ['B', round(np.mean(model.b), 3), round(np.var(model.b), 3)],\n            ['C', round(np.mean(model.c), 3), round(np.var(model.c), 3)]]\n\n    print(\"\\n\\nTable of expected values and variances:\")\n    print(tabulate(data, headers=['Variable', 'Expected value', 'Expected variance'], numalign=\"left\"))\n\n    # model.plotHist(dist=[\"a\", \"b\", \"c\"])\n    model.plotHist(dist=[\"d\", \"e\", \"f\"])\n\n    structEqModel(n=1000, intervene=True).plotHist(dist=[\"d\", \"e\", \"f\"])\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/structEqModel.py b/structEqModel.py
--- a/structEqModel.py	(revision afcd5f10c711cb0e3bb1ead339e7b168c2210042)
+++ b/structEqModel.py	(date 1650546363981)
@@ -36,7 +36,7 @@
     def plotSamples(self, samples, node='all', pd = False):
         if pd and node != 'all':
             plt.hist(samples[node], bins=20)
-            plt.show()misc
+            plt.show()
 
         else:
             all_nodes = ['A', 'B', 'C', 'D']
Index: .Rhistory
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.Rhistory b/.Rhistory
new file mode 100644
--- /dev/null	(date 1650610120215)
+++ b/.Rhistory	(date 1650610120215)
@@ -0,0 +1,512 @@
+pf(1,df1 = 1,df2 = 1)
+# Opgave 30
+# 5
+pf(1,df1 = 2,df2 = 2)
+# Opgave 30
+# 5
+pf(-1,df1 = 2,df2 = 2)
+# Opgave 30
+# 5
+pf(1,df1 = 1,df2 = 1)
+read.table("http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/SAheart.data",
+sep=",",head=T,row.names=1)
+table read.table("http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/SAheart.data",
+sep=",",head=T,row.names=1)
+table <- read.table("http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/SAheart.data",
+sep=",",head=T,row.names=1)
+table = read.table("http://www-stat.stanford.edu/~tibs/ElemStatLearn/datasets/SAheart.data",
+sep=",",head=T,row.names=1)
+k <- 100000
+## 1. Simulate k samples of each nA=9 and nB=9 exponentials with the
+## right means and standard deviations
+simAsamples <- replicate(k, rnorm(nA, mean(xA), sd(xA)))
+simBsamples <- replicate(k, rnorm(nB, mean(xB), sd(xB)))
+## 2. Compute the difference between the simulated medians k times
+simDifmedians <- apply(simAsamples, 2, median) - apply(simBsamples, 2, median)
+## 3. Find the two relevant quantiles of the k simulated differences of means
+quantile(simDifmedians, c(0.025, 0.975))
+## 3. Find the two relevant quantiles of the k simulated differences of means
+quantile(simDifmedians, c(0.025, 0.975))
+################################
+# eNote 1 - Data Visualization #
+################################
+## Ikke super relevant
+## Sample variance and standard deviation
+var(x)
+sqrt(var(x))
+sd(x)
+## Sample quartiles
+quantile(x, type=2)
+## Sample quantiles 0%, 10%,..,90%, 100%:
+quantile(x, probs=seq(0, 1, by=0.10), type=2)
+####################################
+# eNote 2 - Probability simulation #
+####################################
+## Simulate a fair dice
+## Number of simulated realizations
+n <- 30
+## Draw independently from the set (1,2,3,4,5,6) with equal probability
+xFair <- sample(1:6, size=n, replace=TRUE)
+## Simulate 30 successive dice rolls
+Xfair <- sample(1:6, size=30, replace=TRUE)
+## Count the number sixes obtained
+sum(Xfair==6)
+## This is equivalent to
+rbinom(1, size=30, prob=1/6)
+## Probability of x goals in 10 minutes with lambda rate
+## The Poisson pdf
+dpois(x=x, lambda=lambda)
+## Use the cdf to calculate the probability of getting the observed
+## sample standard deviation or higher
+1 - pchisq(chiSqValue, df=n-1)
+################################################
+# eNote 3 - Statistics under normal assumption #
+################################################
+## 1.96 is standard
+## The P(T>1.96) probability  for n=10
+1 - pt(1.96, df = 9)
+## The P(Z>1.96) probability
+1 - pnorm(1.96)
+## The standard normal 0.975% quantile (0.05 conf.level)
+qnorm(0.975)
+## The t-quantiles for n=10:
+qt(0.975, 9)
+## The 99% confidence interval for the mean, one sample
+A <- c(8.360, 6.377,  7.385, 6.245, 8.766, 6.848, 6.074, 6.310, 5.946, 8.270)
+t.test(A, conf.level = 0.99)
+## The 99% confidence interval for the mean, two samples
+A <- c(8.360, 6.377,  7.385, 6.245, 8.766, 6.848, 6.074, 6.310, 5.946, 8.270)
+B <- c(8.806, 6.513, 10.209, 5.495, 6.513, 8.529, 8.354, 5.681, 7.553, 6.834)
+t.test(A,B,conf.level = 0.99)
+### Example
+## Enter sleep difference observations
+x <- c(1.2, 2.4, 1.3, 1.3, 0.9, 1.0, 1.8, 0.8, 4.6, 1.4)
+n <- length(x)
+## Compute the tobs - the observed test statistic
+tobs <- (mean(x) - 0) / (sd(x) / sqrt(n))
+tobs
+## Compute the p-value as a tail-probability in the t-distribution
+pvalue <- 2 * (1-pt(abs(tobs), df=n-1))
+pvalue
+t.test(x)
+## The probability of observed greater that t_obs
+1 - pt(t_obs, df = nu)
+## Finding the power of detecting a group difference of 2
+## with sigma=1 for n=10
+power.t.test(n=10, delta=2, sd=1, sig.level=0.05)
+## Finding the sample size for detecting a group difference of 2
+## with sigma=1 and power=0.9
+power.t.test(power=0.90, delta=2, sd=1, sig.level=0.05)
+## Finding the detectable effect size (delta)
+## with sigma=1, n=10 and power=0.9
+power.t.test(power=0.90, n=10, sd=1, sig.level=0.05)
+#########################################
+# eNote 4 - Simulation based statistics #
+#########################################
+################################################################
+## Nutrition study: comparing medians assuming normal distributions
+##
+## Read the data
+xA <- c(7.53, 7.48, 8.08, 8.09, 10.15, 8.4, 10.88, 6.13, 7.9)
+xB <- c(9.21, 11.51, 12.79, 11.85, 9.97, 8.79, 9.69, 9.68, 9.19)
+nA <- length(xA)
+nB <- length(xB)
+set.seed(9843)
+## Set the number of simulations
+k <- 100000
+## 1. Simulate k samples of each nA=9 and nB=9 exponentials with the
+## right means and standard deviations
+simAsamples <- replicate(k, rnorm(nA, mean(xA), sd(xA)))
+simBsamples <- replicate(k, rnorm(nB, mean(xB), sd(xB)))
+## 2. Compute the difference between the simulated medians k times
+simDifmedians <- apply(simAsamples, 2, median) - apply(simBsamples, 2, median)
+## 3. Find the two relevant quantiles of the k simulated differences of means
+quantile(simDifmedians, c(0.025, 0.975))
+## Install the bootstrap package
+install.packages("bootstrap")
+## Calculate the 95% CI for the Teech and bottle example above
+library(bootstrap)
+quantile(bootstrap(simmeandifs,k,mean)$thetastar, c(0.025,0.975))
+######################################
+# eNote 5 - Simple linear regression #
+######################################
+## Read data
+x <- c(168, 161, 167, 179, 184, 166, 198, 187, 191, 179)
+y <- c(65.5, 58.3, 68.1, 85.7, 80.5, 63.4, 102.6, 91.4, 86.7, 78.9)
+## Calculate averages
+xbar <- mean(x)
+ybar <- mean(y)
+## Parameters estimates
+Sxx <- sum((x - xbar)^2)
+beta1hat <- sum((x - xbar)*(y - ybar)) / Sxx
+beta0hat <- ybar - beta1hat * xbar
+D <- data.frame(x=x, y=y)
+fitStudents <- lm(y ~ x, data=D)
+summary(fitStudents)
+## Confidence intervals
+confint(fit, level = 0.95)
+beta0 <- coef(fitStudents)[1]
+beta1 <- coef(fitStudents)[2]
+########################################
+# eNote 6 - Multiple linear regression #
+########################################
+## Read data
+x1 <- c(0.083, 0.409, 0.515, 0.397, 0.223, 0.292, 0.584, 0.491, 0.923,
+0.280, 0.772, 0.857, 0.758, 0.850, 0.409, 0.055, 0.578, 0.745,
+0.886, 0.031)
+x2 <- c(0.625, 0.604, 0.077, 0.414, 0.343, 0.202, 0.840, 0.266, 0.831,
+0.385, 0.821, 0.308, 0.440, 0.865, 0.111, 0.970, 0.192, 0.939,
+0.149, 0.318)
+y <- c(0.156, 1.234, 0.490, 1.649, 0.500, 0.395, 1.452, 0.416, 1.390,
+0.234, 1.574, 0.349, 1.287, 1.709, 0.323, 1.201, 1.210, 1.787,
+0.591, 0.110)
+## Parameter estimation
+fit <- lm(y ~ x1 + x2)
+## Summary of fit (parameter estimates, standard error, p-values, etc.)
+summary(fit)
+## Confidence intervals
+confint(fit, level = 0.95)
+## Use same commands as single linear regression otherwise
+## Just be aware of the multiple variables present
+##########################################
+# eNote 7 - Proportions frequency tables #
+##########################################
+## TESTING THE PROBABILITY = 0.5 WITH A TWO-SIDED ALTERNATIVE
+## WE HAVE OBSERVED 518 OUT OF 1154
+## WITHOUT CONTINUITY CORRECTIONS
+prop.test(x=518, n=1154, p = 0.5, correct = FALSE)
+## TESTING THAT THE PROBABILITIES FOR THE TWO GROUPS ARE EQUAL
+## CALCULATING 99% CONFINDECE INTERVAL
+prop.test(x=c(23,35), n=c(57,167), correct=FALSE, conf.level=0.99)
+## EXAMPLE
+pill.study <- matrix(c(23, 35, 34, 132), ncol = 2, byrow = TRUE)
+rownames(pill.study) <- c("Blood Clot", "No Clot")
+colnames(pill.study) <- c("Pill", "No pill")
+pill.study
+# CHI2 TEST FOR TESTING THE PROBABILITIES FOR THE TWO GROUPS ARE EQUAL
+chisq.test(pill.study, correct = FALSE)
+#IF WE WANT THE EXPECTED NUMBERS SAVE result IN AN OBJECT
+chi <- chisq.test(pill.study, correct = FALSE)
+#THE EXPECTED VALUES
+chi$expected
+#THE CONTRIBUTIONS
+contrib <- 100*chi$residuals^2/chi$statistic
+contrib
+library(corrplot)
+corrplot(contrib, is.cor = FALSE)
+#########################################
+# eNote 8 - Statistics Multigroup ANOVA #
+#########################################
+## One Way ANOVA
+k <- 5; n <- 10
+SStr <- 7.3; SSbl <- 77.5; SSE <-  89.1
+MStr <- SStr/(k-1)
+MSE <- SSE/n-k
+Ftr <- MStr/MSE
+(1-pf(abs(Ftr),k-1,(k-1)*(l-1))); (1-pf(abs(Fbl),l-1,(k-1)*(l-1)))
+SST <- SStr + SSbl + SSE
+## Two Way ANOVA
+k <- 5; l <- 8
+SStr <- 7.3; SSbl <- 77.5; SSE <-  89.1
+MStr <- SStr/(k-1); MSbl <- SSbl/(l-1)
+MSE <- SSE/((k-1)*(l-1))
+Ftr <- MStr/MSE; Fbl <- MSbl/MSE
+(1-pf(abs(Ftr),k-1,(k-1)*(l-1))); (1-pf(abs(Fbl),l-1,(k-1)*(l-1)))
+SST <- SStr + SSbl + SSE
+## Explained variance
+1-(SSE/SST)
+## Example
+y <- c(2.8, 3.6, 3.4, 2.3,
+5.5, 6.3, 6.1, 5.7,
+5.8, 8.3, 6.9, 6.1)
+treatm <- factor(c(1, 1, 1, 1,
+2, 2, 2, 2,
+3, 3, 3, 3))
+plot(treatm,y)
+mu <- mean(y)
+muis <- tapply(y, treatm, mean)
+alpha <- muis - mu
+mu
+muis
+alpha
+tapply(y, treatm, var)
+SST <- sum((y - mu)^2)
+SSE <- sum((y[treatm==1] - muis[1])^2)+
+sum((y[treatm==2] - muis[2])^2)+
+sum((y[treatm==3] - muis[3])^2)
+SSTr <- 4 * sum(alpha^2)
+c(SST, SSE, SSTr)
+vars <- tapply(y, treatm, var)
+(12-3)*mean(vars)
+x<-seq(0,5,by=0.01)
+plot(x,df(x,df1=2,df2=9),type="l", xlab="$x$", ylab="pdf")
+lines(x,df(x,df1=4,df2=9),col=2)
+F <- (SSTr/(3 - 1)/(SSE/(12 - 3)))
+pv <- 1 - pf(F, df1 = 3 - 1, df2 = 12 - 3)
+c(F , pv)
+anova(lm(y ~ treatm))
+muis[1] - muis[2] + c(-1, 1) *
+qt(0.975, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+tobs <- (muis[1] - muis[2])/sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+2 * (1 - pt(abs(tobs), 9))
+alphaBonf <- 0.05/3
+## A-B
+alpha[1] - alpha[2] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+## A-C
+alpha[1] - alpha[3] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+## B-C
+alpha[2] - alpha[3] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+c(qt(1 - alphaBonf/2, 9), qt(0.975, 9))
+residuals <- lm(y ~ treatm)$residuals
+qqnorm(residuals)
+qqline(residuals)
+residuals
+y <- c(2.8, 3.6, 3.4, 2.3,
+5.5, 6.3, 6.1, 5.7,
+5.8, 8.3, 6.9, 6.1)
+treatm <- factor(c(1, 1, 1, 1,
+2, 2, 2, 2,
+3, 3, 3, 3))
+plot(as.numeric(treatm), y, pch=19, xlim=c(0.5, 3.5), axes=FALSE, xlab="Treatment", ylab="", cex=0.7)
+lines(c(0,4),c(1,1)*mean(y),col=2)
+lines(c(1,1),c(mean(y),mean(y[treatm==1])),col="blue")
+lines(c(2,2),c(mean(y),mean(y[treatm==2])),col="blue")
+lines(c(3,3),c(mean(y),mean(y[treatm==3])),col="blue")
+box()
+axis(1,at=c(1,2,3),labels=c("1","2","3"))
+axis(2,at=c(mean(y),mean(y[treatm==1]),mean(y[treatm==2]),mean(y[treatm==3])),labels=c("$\\hat{\\mu}$","$\\hat{\\mu}_{1}$","$\\hat{\\mu}_{2}$","$\\hat{\\mu}_{3}$"), las=1)
+points(c(1,2,3),c(mean(y[treatm==1]),mean(y[treatm==2]),mean(y[treatm==3])),pch=19,col=2,cex=1.2)
+text(1,(mean(y)+mean(y[treatm==1]))/2,labels="$\\hat{\\alpha}_1$",adj=c(-1,0),col="blue")
+text(2,(mean(y)+mean(y[treatm==2]))/2,labels="$\\hat{\\alpha}_2$",adj=c(-1,0),col="blue")
+text(3,(mean(y)+mean(y[treatm==3]))/2,labels="$\\hat{\\alpha}_3$",adj=c(-1,0),col="blue")
+text(1,min(y),labels="$y_{1,j}$",adj=c(-1,0),col=1)
+y <- c(2.8, 3.6, 3.4, 2.3,
+5.5, 6.3, 6.1, 5.7,
+5.8, 8.3, 6.9, 6.1)
+treatm <- factor(c(1, 1, 1, 1,
+2, 2, 2, 2,
+3, 3, 3, 3))
+plot(treatm,y)
+mu <- mean(y)
+muis <- tapply(y, treatm, mean)
+alpha <- muis - mu
+mu
+muis
+alpha
+tapply(y, treatm, var)
+SST <- sum((y - mu)^2)
+SSE <- sum((y[treatm==1] - muis[1])^2)+
+sum((y[treatm==2] - muis[2])^2)+
+sum((y[treatm==3] - muis[3])^2)
+SSTr <- 4 * sum(alpha^2)
+c(SST, SSE, SSTr)
+vars <- tapply(y, treatm, var)
+(12-3)*mean(vars)
+x<-seq(0,5,by=0.01)
+plot(x,df(x,df1=2,df2=9),type="l", xlab="$x$", ylab="pdf")
+lines(x,df(x,df1=4,df2=9),col=2)
+F <- (SSTr/(3 - 1)/(SSE/(12 - 3)))
+pv <- 1 - pf(F, df1 = 3 - 1, df2 = 12 - 3)
+c(F , pv)
+anova(lm(y ~ treatm))
+muis[1] - muis[2] + c(-1, 1) *
+qt(0.975, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+tobs <- (muis[1] - muis[2])/sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+2 * (1 - pt(abs(tobs), 9))
+alphaBonf <- 0.05/3
+## A-B
+alpha[1] - alpha[2] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+## A-C
+alpha[1] - alpha[3] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+## B-C
+alpha[2] - alpha[3] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 12 - 3) * sqrt(SSE/(12 - 3) * (1/4 + 1/4))
+c(qt(1 - alphaBonf/2, 9), qt(0.975, 9))
+residuals <- lm(y ~ treatm)$residuals
+qqnorm(residuals)
+qqline(residuals)
+residuals
+D <- data.frame(
+strength=c(44.6, 52.8, 53.1, 51.5, 48.2, 50.5, 58.3, 50.0, 53.7, 40.8,
+46.3, 55.4, 54.4, 50.5, 44.5, 48.5, 57.4, 55.3, 54.4, 43.9,
+45.2, 58.1, 50.6, 47.5, 45.9, 52.3, 54.6, 53.4, 47.8, 42.5),
+plastictype=factor(rep(1:5, 6))
+)
+plot(D$plastictype, D$strength, xlab="Plastictype", ylab="Strength")
+fit <- lm(strength ~ plastictype, data=D)
+anova(fit)
+library(xtable)
+print(xtable(anova(fit)))
+qqnorm(fit$residuals)
+qqline(fit$residuals)
+set.seed(138)
+library(MESS)
+qqwrap <- function(x, y, ...){
+stdy <- (y-mean(y))/sd(y)
+qqnorm(stdy, main="", ...)
+qqline(stdy)}
+wallyplot(fit$residuals, FUN=qqwrap, ylim=c(-3,3))
+tapply(D$strength, D$plastictype, mean)
+LSD_0.005 <- qt(0.9975, 25) * sqrt(2*6.74/6)
+LSD_0.005
+y <- c(2.8, 3.6, 3.4, 2.3,
+5.5, 6.3, 6.1, 5.7,
+5.8, 8.3, 6.9, 6.1)
+treatm <- factor(c(1, 1, 1, 1,
+2, 2, 2, 2,
+3, 3, 3, 3))
+block <- factor(c(1, 2, 3, 4,
+1, 2, 3, 4,
+1, 2, 3, 4))
+mu <- mean(y)
+alpha <- tapply(y, treatm, mean) - mu
+beta <- tapply(y, block, mean)  - mu
+mu
+alpha
+beta
+SSBl <- 3 * sum(beta^2)
+SSE <- SST - SSTr - SSBl
+c(SST, SSE, SSTr, SSBl)
+## Test statistics
+Ftr <- SSTr / (3-1) / ( SSE / ((3-1) * (4-1)))
+Fbl <- SSBl / (4-1) / ( SSE / ((3-1) * (4-1)))
+## p-values
+pv.tr <- 1 - pf(Ftr, df1=3-1, df2=(3-1)*(4-1))
+pv.bl <- 1 - pf(Fbl, df1=4-1, df2=(3-1)*(4-1))
+c(Ftr, Fbl)
+c(pv.tr, pv.bl)
+D <- data.frame(treatm, block, y)
+fit <- lm(y ~ treatm + block, data=D)
+anova(fit)
+muis[1] - muis[2] + c(-1,1) * qt(0.975, df=(4-1)*(3-1)) *
+sqrt(SSE/((4-1)*(3-1)) * (1/4+1/4))
+tobs <- (muis[1] - muis[2])/sqrt(SSE/6 * (1/4 + 1/4))
+2 * (1 - pt(abs(tobs), df=6))
+alphaBonf <- 0.05/3
+## A vs. B
+alpha[1] - alpha[2] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 6) * sqrt(SSE/6 * (1/4 + 1/4))
+## A vs. C
+alpha[1] - alpha[3] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 6) * sqrt(SSE/6 * (1/4 + 1/4))
+## B vs. C
+alpha[2] - alpha[3] + c(-1, 1) *
+qt(1-alphaBonf/2, df = 6) * sqrt(SSE/6 * (1/4 + 1/4))
+qqnorm(fit$residuals)
+qqline(fit$residuals)
+fit$residuals
+par(mfrow=c(1,2))
+plot(D$treatm, fit$residuals, xlab="Treatment", ylab="Residuals")
+plot(D$block, fit$residuals, xlab="Block", ylab="Residuals")
+## Collecting the data in a data frame
+D <- data.frame(
+y=c(22.5, 24.3, 24.9, 22.4,
+21.5, 21.3, 23.9, 18.4,
+22.2, 21.9, 21.7, 17.9),
+car=factor(c(1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4)),
+tire=factor(c(1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3))
+)
+par(mfrow=c(1,2))
+plot(D$tire, D$y, xlab="Tire", ylab="y")
+plot(D$car, D$y, xlab="Car", ylab="y")
+fit <- lm(y ~ car + tire, data=D)
+anova(fit)
+qqnorm(fit$residuals)
+qqline(fit$residuals)
+par(mfrow=c(1,2))
+plot(D$car, fit$residuals, xlab="Car", ylab="Residuals")
+plot(D$tire, fit$residuals, xlab="Tire", ylab="Residuals")
+tapply(D$y, D$tire, mean)
+LSD_bonf <- qt(1-0.05/6, df=6) * sqrt(2*1.19/4)
+LSD_bonf
+AccDGT  <- predDGT %>% group_by(Fold) %>%
+summarise(RMSEDGT = sqrt(mean((day30 - pred)^2)))
+solve(3,9)
+quad <- function(a, b, c)
+{
+a <- as.complex(a)
+answer <- c((-b + sqrt(b^2 - 4 * a * c)) / (2 * a),
+(-b - sqrt(b^2 - 4 * a * c)) / (2 * a))
+if(all(Im(answer) == 0)) answer <- Re(answer)
+if(answer[1] == answer[2]) return(answer[1])
+answer
+}
+quad(1,2,3)
+quad(1,2,0)
+source("~/Desktop/DTU/2. semester/Matstat/Stat/eNote_kode.R")
+setwd("~/Desktop/DTU/4. semester/Active Machine Learning and Agency/Project3")
+data <- read.csv("/sample/data_435")
+data <- read.csv("/sample/data_435")
+data <- read.csv("sample/data_435")
+library(readr)
+data_435 <- read_csv("sample/data_435.csv")
+View(data_435)
+data_435 <- read_csv("sample/data_435.csv")
+View(data_435)
+hist(data_435)
+hist(data_435['A'])
+library(readr)
+data <- read_csv("sample/data_435.csv")
+View(data)
+data[1]
+data[2]
+hist(data[2])
+data[2]
+hist(data[2].values())
+hist(data$A)
+hist(data$B)
+hist(data$C)
+hist(data$D)
+fiti <- lm(A ~ B , data = data)
+interact_plot(fiti, pred = A, modx = B)
+library(jtools) # for summ()
+data <- read_csv("sample/data_435.csv")
+View(data)
+fiti <- lm(A ~ B , data = data)
+interact_plot(fiti, pred = A, modx = B)
+library(ggplot2)
+fiti <- lm(A ~ B , data = data)
+interact_plot(fiti, pred = A, modx = B)
+interact_plot(fiti)
+interact(fiti)
+library(interactions)
+fiti <- lm(A ~ B , data = data)
+interact(fiti)
+interact:plot(fiti)
+interact_plot(fiti)
+interact_plot(fiti, pred = A, modx = B)
+interact_plot(fiti, pred = A, modx = B)
+fiti <- lm(A ~ B , data = data)
+interact_plot(fiti, pred = A, modx = B)
+interaction.plot(fiti, pred = A, modx = B)
+interaction.plot(fiti)
+fiti <- lm(A ~ B + C, data = data)
+interaction.plot(data, c(A, B), fiti)
+interaction.plot(data, c(data$A, data$B), fiti)
+interaction.plot(, c(data$A, data$B), fiti)
+interaction.plot(data$A, c(data$A, data$B), fiti)
+interaction.plot(data$A, data$B, data$C)
+interaction.plot(data$A, data$B)
+interaction.plot(data$A, data$B, fiti)
+interaction.plot(data$A, data$B, data$C)
+interaction.plot(data$A, data$B, data$X1)
+par(mfrow=c(3,1))
+hist(data$A)
+par(mfrow=c(2,2))
+hist(data$A)
+hist(dataint$A)
+dataint <- read_csv("sample/data_518.csv")
+par(mfrow=c(2,2))
+hist(data$A)
+hist(dataint$A)
+hist(data$B)
+hist(dataint$B)
+hist(data$C)
+hist(dataint$C)
+hist(data$D)
+hist(dataint$D)
Index: r_causality.R
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/r_causality.R b/r_causality.R
new file mode 100644
--- /dev/null	(date 1650610109048)
+++ b/r_causality.R	(date 1650610109048)
@@ -0,0 +1,22 @@
+library(readr)
+library(jtools) # for summ()
+library(interactions)
+library(ggplot2)
+
+data <- read_csv("sample/data_435.csv")
+dataint <- read_csv("sample/data_518.csv")
+
+par(mfrow=c(2,2))
+hist(data$A)
+hist(dataint$A)
+hist(data$B)
+hist(dataint$B)
+
+hist(data$C)
+hist(dataint$C)
+hist(data$D)
+hist(dataint$D)
+
+
+#fiti <- lm(A ~ B + C, data = data)
+#interaction.plot(data$A, data$B, data$X1)
